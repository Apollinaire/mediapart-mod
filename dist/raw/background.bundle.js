(()=>{"use strict";const e=["zenMode","darkTheme"],o={zenMode:!0,darkTheme:!0},t=()=>new Promise((t=>{chrome.storage.sync.get(e,(e=>{t({...o,...e})}))})),s=e=>{chrome.tabs.sendMessage(e,{method:"applyStyles"})},a=()=>{chrome.tabs.query({},((e=[])=>{e.forEach((e=>{s(e.id)}))}))};console.log("start background"),chrome.runtime.onMessage.addListener(((e,o,t)=>{const{method:s}=e;switch(s){case"getStyles":return void t({done:!0})}})),chrome.webNavigation.onCommitted.addListener((function(e){if(console.log("onCommited",e),new URL(e.url).host.endsWith("mediapart.fr"))try{console.log("send applyStyles"),s(e.tabId)}catch(e){console.log(e)}})),chrome.commands.onCommand.addListener((async e=>{switch(e){case"toggle-theme":const{darkTheme:n}=await t();console.log({command:e,darkTheme:n}),await(s=!n,new Promise((e=>{chrome.storage.sync.set({darkTheme:s},e)}))),a();break;case"toggle-zen":const{zenMode:r}=await t();await(o=!r,new Promise((e=>{chrome.storage.sync.set({zenMode:o},e)}))),a()}var o,s}))})();